<app-dialog-page-header [title]="title"></app-dialog-page-header>


<mat-horizontal-stepper [linear]="isLinear" #stepper>
    <mat-step [stepControl]="subProjectform">
        <ng-template matStepLabel>Sub-Project Details</ng-template>
        <form [formGroup]="subProjectform" autocomplete="off">
            <mat-dialog-content>
<div class="row">
     <div class="row">
                    <div class="col-md-4">
                        <mat-form-field>
                            <mat-label>Region</mat-label>
                            <mat-select formControlName="region">
                                <mat-option *ngFor="let region of regions" (click)="onRegionChange(region)"
                                    [value]="region">{{ region.name}}</mat-option>
                            </mat-select>
                            <mat-error>This field is required!</mat-error>
                        </mat-form-field>
                    </div>

                    <div class="col-md-4">
                        <mat-form-field>
                            <mat-label>Select Council</mat-label>
                            <mat-select formControlName="council">
                                <mat-option *ngFor="let council of councils" (click)="onCouncilChange(council.code)" [value]="council.code">{{
                                    council.name
                                    }}</mat-option>
                            </mat-select>
                            <mat-error>This field is required!</mat-error>
                        </mat-form-field>
                    </div>
           <div class="col-4">
                        <mat-form-field>
                            <mat-label>Select Package</mat-label>
                            <mat-select matInput formControlName="projectPackageId">
                                <mat-option *ngFor="let package of packages" [value]="package.id">{{ package.name
                                    }}</mat-option>
                            </mat-select>

                        </mat-form-field>
                    </div>
              
                </div>
                <div class="row">
      <div class="col-4">
                        <mat-form-field>
                            <mat-label>Sub Project Name</mat-label>
                            <input matInput formControlName="name" type="text" placeholder="Sub Project Name" />
                            <mat-error>This is a required field!</mat-error>
                        </mat-form-field>
                    </div>
                    <div class="col-4">
                        <mat-form-field>
                            <mat-label>Amount</mat-label>
                            <input matInput formControlName="amount" type="number" placeholder="sub-Project Amount" />
                            <mat-error>This is a required field!</mat-error>
                        </mat-form-field>
                    </div>
                    <div class="col-4">
                        <mat-form-field>
                            <mat-label>Weight</mat-label>
                            <input matInput formControlName="weight" type="number" placeholder="sub-Project Weight" />
                            <mat-error>This is a required field!</mat-error>
                        </mat-form-field>
                    </div>

            

                </div>
                <div class="row">
        <div class="col-4">
                        <mat-form-field>
                            <mat-label>Choose Work Category</mat-label>
                            <mat-select matInput formControlName="workCategoryTypeId">
                                <mat-option *ngFor="let cat of categories" [value]="cat.setupUUID">{{ cat.name}}</mat-option>
                            </mat-select>
                            <mat-error>This is a required field!</mat-error>
                        </mat-form-field>
                    </div>
                    <div class="col-4">
                        <mat-form-field>
                            <mat-label>Length/Quantity</mat-label>
                            <input matInput formControlName="lengthOrQuantity" type="text"
                                placeholder="Enter Length/Quantity" />
                            <mat-error>This is a required field!</mat-error>
                        </mat-form-field>
                    </div>
                    <div class="col-4">
                        <mat-form-field>
                            <mat-label>Measurement Unit</mat-label>
                            <mat-select matInput formControlName="measurementUnitId">
                                <mat-option *ngFor="let measure of measurements" [value]="measure.setupUUID">{{ measure.name
                                    }}</mat-option>
                            </mat-select>
                        </mat-form-field>
                    </div>
         
</div>
                </div>

            </mat-dialog-content>
            <app-button class="button" (click)="goForward(stepper, subProjectform.value)" buttonName="Next"
                _icon="ri-add-line align-bottom me-1"> </app-button>

            <!-- <button class="form-button" type="submit" mat-raised-button mat-fab extended color="primary"
                (click)="goForward(stepper)" [disabled]="subProjectform.invalid">
                <span class="text-button">Next&nbsp;<b>>></b></span>
            </button> -->
        </form>

    </mat-step>
    <!-- -->
    <mat-step [stepControl]="itemForm">
        <ng-template matStepLabel>Asign Items into Sub-Projects</ng-template>

        <mat-dialog-content>
            <div class="row">
  <form [formGroup]="itemForm" autocomplete="off">
<div class="row">
           <div class="col-3">
                        <mat-form-field>
                            <mat-label>Item Name</mat-label>
                            <input matInput formControlName="name" type="text" placeholder="Item Name" />
                            <mat-error>This is a required field!</mat-error>
                        </mat-form-field>
                    </div>
      <div class="col-2">
                        <mat-form-field>
                            <mat-label>Quantity</mat-label>
                            <input matInput formControlName="requiredQuantity" type="number" placeholder="length/quantity" />
                            <mat-error>This is a required field!</mat-error>
                        </mat-form-field>
                    </div>
      <div class="col-2">
                        <mat-form-field>
                            <mat-label>QuantityProgress</mat-label>
                            <input matInput formControlName="quantityProgress" type="number" placeholder="Progress" />
                            <mat-error>This is a required field!</mat-error>
                        </mat-form-field>
                    </div>
         <div class="col-3">
                        <mat-form-field>
                            <mat-label>Measurement Unit</mat-label>
                            <mat-select matInput formControlName="measurementUnitId">
                                <mat-option *ngFor="let measure of measurements" [value]="measure">{{ measure.name
                                    }}</mat-option>
                            </mat-select>
                        </mat-form-field>
                    </div>
  <div class="col-2">
   <app-button class="button mt-2" (click)="addItem(itemForm.value)" buttonName="AddItem" _icon="ri-add-line align-bottom me-1"> </app-button>
</div>
</div>
</form>
<hr>
                <div class="row">
                    <table *ngIf="subProjectItems.length>0">
                        <thead>
                            <th>No</th>
                            <th>Item Name</th>
                            <th>Quantity</th>
                            <th>Progress</th>
                            <th>Unit</th>
                            <th>Action</th>
                        </thead>
                        <tbody>
                            <tr *ngFor="let item of subProjectItems let i=index">
                                <td>{{i+1}}</td>
                                <td>{{item.name}}</td>
                                <td>{{item.requiredQuantity}}</td>
                                <td>{{item.quantityProgress}}</td>
                                 <td>{{item.measurementUnitId.name}}</td>
                                <td><mat-icon (click)="removeItem(item)" style="color: red;">delete</mat-icon></td>
                            </tr>

                        </tbody>
                    </table>
                </div>

            </div>
        </mat-dialog-content>
<hr>
        <app-button class="button" (click)="save()" buttonName="Save SubProject" _icon="ri-add-line align-bottom me-1">
        </app-button>

        <!-- <button class="form-button-back" type="submit" mat-raised-button mat-fab extended color="yellow"
            (click)="goBack(stepper)">
            <span class="text-button"><b> << </b>&nbsp;BACK</span>
        </button> -->
        <div class="spacer"></div>
        <!-- <button class="form-button" type="submit" mat-raised-button mat-fab extended color="primary" (click)="save()" >
            <mat-icon>save</mat-icon>
            <span class="text-button">{{ label }}</span>
        </button> -->
    </mat-step>
</mat-horizontal-stepper>